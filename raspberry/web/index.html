<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="A layout example with a side menu that hides on mobile, just like the Pure website.">

    <title>Smart Meter &ndash; Layout Examples &ndash; Pure</title>

    <link rel="stylesheet" href="css/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="css/layouts/side-menu.css">
    <!--<![endif]-->

<script src="js/plotly-latest.min.js"></script>

</head>
<body onload="init()">

<div id="layout">
    <!-- Menu toggle -->
    <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>

    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="#">Meter</a>

            <ul class="pure-menu-list">
                <li class="pure-menu-item"><a href="#" class="pure-menu-link">Real-time</a></li>
                <li class="pure-menu-item"><a href="#" class="pure-menu-link">History</a></li>
                <li class="pure-menu-item"><a href="#" class="pure-menu-link">Config</a></li>
            </ul>
        </div>
    </div>

    <div id="main">
        <div class="header">
            <h1 id="hostname"></h1>
            <h2>Real time data from aquisition board.</h2>
                    <a onclick="reload_data(0)" class="pure-button">Channel 0</a>
                    <a onclick="reload_data(1)" class="pure-button">Channel 1</a>
                    <a onclick="reload_data(2)" class="pure-button">Channel 2</a>
                    <a onclick="reload_data(3)" class="pure-button">Channel 3</a>
                    <a onclick="reload_data(4)" class="pure-button">Channel 4</a>
                    <a onclick="reload_data(5)" class="pure-button">Channel 5</a>
                    <a onclick="reload_data(6)" class="pure-button">Channel 6</a>
        </div>

        <h2 id="channel_num" class="content-subhead" style="margin-left: 50px"></h2>
        <div style="width: 90%; overflow: hidden; margin-left: auto; margin-right: auto">
            <div style="width: 50%; float: left; text-align: center">
                Voltage
                <div id="inst_voltage"></div>
                <h1 id="voltage_rms"></h1>
            </div>
            <div style="width: 50%; margin-left: 50%; text-align: center">
                Current
                <div id="inst_current"></div>
                <h1 id="current_rms"></h1>
            </div>
        </div>
    </div>
    <footer style="text-align: center">
        <p id="aq_date"></p>
    </footer>
</div>


<script>
    function init() {
        document.getElementById("hostname").innerHTML = location.hostname;
        reload_data(0);
    }
    function reload_data(channel) {
        var request = new XMLHttpRequest();
        request.open("GET", "sensor_data_" + channel +".json", false);
        request.send(null)
        var DATA = JSON.parse(request.responseText);
        INST_VOLT = document.getElementById('inst_voltage');
        Plotly.newPlot( INST_VOLT, [{
                     y: DATA["voltage"] }], {
                     margin: { t: 0 } } );
        INST_CURR = document.getElementById('inst_current');
        Plotly.newPlot( INST_CURR, [{
                     y: DATA["current"] }], {
                     margin: { t: 0 } } );
        document.getElementById("voltage_rms").innerHTML = "Vrms: " + DATA["voltage_rms"];
        document.getElementById("current_rms").innerHTML = "Irms: " + DATA["current_rms"];
        document.getElementById("aq_date").innerHTML = DATA["date"];
        document.getElementById("channel_num").innerHTML = "Channel " + channel;
    }
</script>
<script src="js/ui.js"></script>

</body>
</html>
